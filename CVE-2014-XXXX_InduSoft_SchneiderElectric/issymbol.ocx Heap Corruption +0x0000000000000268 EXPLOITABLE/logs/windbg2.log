Opened log file 'y:\crash2.log'
0:000> .lastevent
Last event: 77c.b98: Access violation - code c0000005 (first chance)
  debugger time: Tue Jun 17 15:14:32.089 2014 (UTC + 4:00)
0:000> r
eax=00000000 ebx=00000010 ecx=00000004 edx=00000000 esi=0a3020ed edi=0a320ff4
eip=62eaaf7c esp=0012a614 ebp=0012a61c iopl=0         nv up ei ng nz ac pe cy
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010297
MSVCR90!memcpy+0x15c:
62eaaf7c 89448ffc        mov     dword ptr [edi+ecx*4-4],eax ds:0023:0a321000=????????
0:000> u eip-30 l30
MSVCR90!memcpy+0x12c:
62eaaf4c 89448fe4        mov     dword ptr [edi+ecx*4-1Ch],eax
62eaaf50 8b448ee8        mov     eax,dword ptr [esi+ecx*4-18h]
62eaaf54 89448fe8        mov     dword ptr [edi+ecx*4-18h],eax
62eaaf58 8b448eec        mov     eax,dword ptr [esi+ecx*4-14h]
62eaaf5c 89448fec        mov     dword ptr [edi+ecx*4-14h],eax
62eaaf60 8b448ef0        mov     eax,dword ptr [esi+ecx*4-10h]
62eaaf64 89448ff0        mov     dword ptr [edi+ecx*4-10h],eax
62eaaf68 8b448ef4        mov     eax,dword ptr [esi+ecx*4-0Ch]
62eaaf6c 89448ff4        mov     dword ptr [edi+ecx*4-0Ch],eax
62eaaf70 8b448ef8        mov     eax,dword ptr [esi+ecx*4-8]
62eaaf74 89448ff8        mov     dword ptr [edi+ecx*4-8],eax
62eaaf78 8b448efc        mov     eax,dword ptr [esi+ecx*4-4]
62eaaf7c 89448ffc        mov     dword ptr [edi+ecx*4-4],eax
62eaaf80 8d048d00000000  lea     eax,[ecx*4]
62eaaf87 03f0            add     esi,eax
62eaaf89 03f8            add     edi,eax
62eaaf8b ff249594afea62  jmp     dword ptr MSVCR90!memcpy+0x174 (62eaaf94)[edx*4]
62eaaf92 8bff            mov     edi,edi
62eaaf94 a4              movs    byte ptr es:[edi],byte ptr [esi]
62eaaf95 af              scas    dword ptr es:[edi]
62eaaf96 ea62acafea62b8  jmp     B862:EAAFAC62
62eaaf9d af              scas    dword ptr es:[edi]
62eaaf9e ea62ccafea628b  jmp     8B62:EAAFCC62
62eaafa5 45              inc     ebp
62eaafa6 085e5f          or      byte ptr [esi+5Fh],bl
62eaafa9 c9              leave
62eaafaa c3              ret
62eaafab 90              nop
62eaafac 8a06            mov     al,byte ptr [esi]
62eaafae 8807            mov     byte ptr [edi],al
62eaafb0 8b4508          mov     eax,dword ptr [ebp+8]
62eaafb3 5e              pop     esi
62eaafb4 5f              pop     edi
62eaafb5 c9              leave
62eaafb6 c3              ret
62eaafb7 90              nop
62eaafb8 8a06            mov     al,byte ptr [esi]
62eaafba 8807            mov     byte ptr [edi],al
62eaafbc 8a4601          mov     al,byte ptr [esi+1]
62eaafbf 884701          mov     byte ptr [edi+1],al
62eaafc2 8b4508          mov     eax,dword ptr [ebp+8]
62eaafc5 5e              pop     esi
62eaafc6 5f              pop     edi
62eaafc7 c9              leave
62eaafc8 c3              ret
62eaafc9 8d4900          lea     ecx,[ecx]
62eaafcc 8a06            mov     al,byte ptr [esi]
62eaafce 8807            mov     byte ptr [edi],al
0:000> !analyze -v
*******************************************************************************
*                                                                             *
*                        Exception Analysis                                   *
*                                                                             *
*******************************************************************************

*** ERROR: Module load completed but symbols could not be loaded for Viewer.exe
*** WARNING: Unable to verify checksum for C:\Windows\assembly\NativeImages_v2.0.50727_32\mscorlib\ede2c6c842840e009f01bcc74fa4c457\mscorlib.ni.dll
!pe
There is no current managed exception on this thread
GetUrlPageData2 (WinHttp) failed: 12007.

FAULTING_IP: 
MSVCR90!memcpy+15c
62eaaf7c 89448ffc        mov     dword ptr [edi+ecx*4-4],eax

EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)
.exr 0xffffffffffffffff
ExceptionAddress: 62eaaf7c (MSVCR90!memcpy+0x0000015c)
   ExceptionCode: c0000005 (Access violation)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 00000001
   Parameter[1]: 0a321000
Attempt to write to address 0a321000

FAULTING_THREAD:  00000b98

DEFAULT_BUCKET_ID:  WRONG_SYMBOLS

PROCESS_NAME:  Viewer.exe

ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%08lx referenced memory at 0x%08lx. The memory could not be %s.

EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%08lx referenced memory at 0x%08lx. The memory could not be %s.

EXCEPTION_PARAMETER1:  00000001

EXCEPTION_PARAMETER2:  0a321000

WRITE_ADDRESS:  0a321000 

FOLLOWUP_IP: 
MSVCR90!memcpy+15c
62eaaf7c 89448ffc        mov     dword ptr [edi+ecx*4-4],eax

NTGLOBALFLAG:  0

APPLICATION_VERIFIER_FLAGS:  0

APP:  viewer.exe

MANAGED_STACK: !dumpstack -EE
!dumpstack -EE
OS Thread Id: 0xb98 (0)
Current frame: 
ChildEBP RetAddr  Caller,Callee

PRIMARY_PROBLEM_CLASS:  WRONG_SYMBOLS

BUGCHECK_STR:  APPLICATION_FAULT_WRONG_SYMBOLS

LAST_CONTROL_TRANSFER:  from 62ea69ed to 62eaaf7c

STACK_TEXT:  
0012a61c 62ea69ed 0a320ff4 0a3020ed 00000010 MSVCR90!memcpy+0x15c
0012a638 62553470 0a320ff4 00000010 0a3020ed MSVCR90!memcpy_s+0x4a
0012a650 62552e5b 0a320ff4 00000010 0a3020ed mfc90u!ATL::Checked::memcpy_s+0x17
0012a67c 101f21e3 0a320ff4 00000010 667c62ee mfc90u!CArchive::Read+0x49
WARNING: Stack unwind information not available. Following frames may be wrong.
0012a758 1021e8f0 0012bad0 667c6dae 66fc95d4 ISSymbol!DllUnregisterServer+0x1e8383
0012a818 1025dae0 0012bad0 0a3053b8 0a31c26c ISSymbol!DllUnregisterServer+0x214a90
0012a83c 10263d75 0012bad0 667c7fa2 001ed570 ISSymbol!DllUnregisterServer+0x253c80
0012ba14 10260d88 0012bad0 667c7e9a 00000008 ISSymbol!DllUnregisterServer+0x259f15
0012bb2c 10261cf9 0012bf14 667c06e6 0012ba74 ISSymbol!DllUnregisterServer+0x256f28
0012c350 1028a0fa 0012d10c 667c0616 00000008 ISSymbol!DllUnregisterServer+0x257e99
0012c3a0 10031f70 0012d10c 00000001 667c17e2 ISSymbol!DllUnregisterServer+0x28029a
0012d254 10025fdd 0a207ae0 00000000 10392134 ISSymbol!DllUnregisterServer+0x28110
0012d2ec 1002ff68 0a25d728 80000000 80000000 ISSymbol!DllUnregisterServer+0x1c17d
0012d9d8 10022136 0a2076a0 667c35b6 00000000 ISSymbol!DllUnregisterServer+0x26108
0012f000 1001bfd2 667c317e 00003bf8 0012f04c ISSymbol!DllUnregisterServer+0x182d6
0012f4c8 1003f68d 00000000 667c3c9a 0012f4ec ISSymbol!DllUnregisterServer+0x12172
0012f92c 625d2927 001c0ed4 625bfd23 049dda62 ISSymbol!DllUnregisterServer+0x3582d
0012f9dc 625c03f0 10395008 00000001 00000000 mfc90u!_AfxDispatchCall+0x10
0012fa80 625c11d6 00000001 00000060 62505f88 mfc90u!COleDispatchImpl::Invoke+0x388
0012fb54 625dee36 00000060 00000001 00000000 mfc90u!COleDispatchDriver::InvokeHelperV+0x324
0012fb7c 6258c7d6 00000060 00000001 00000000 mfc90u!COleControlSite::InvokeHelperV+0x57
0012fb9c 004021f1 0039c0c8 00000060 00000001 mfc90u!CWnd::InvokeHelper+0x27
0012fbc4 0040d047 012420b8 0039c000 0039bf00 Viewer+0x21f1
0012fbdc 0040d0f4 0039bf00 0012fc90 6255fafa Viewer+0xd047
0012fbe8 6255fafa 00000064 66fc37fa 00000113 Viewer+0xd0f4
0012fc90 6255f6cc 00000113 00000064 00000000 mfc90u!CWnd::OnWndMsg+0x407
0012fcb0 0040a36c 00000113 00000064 00000000 mfc90u!CWnd::WindowProc+0x24
0012fcc8 6255e2f2 00000113 00000064 00000000 Viewer+0xa36c
0012fd30 6255e57e 00000000 001005f4 00000113 mfc90u!AfxCallWndProc+0xa3
0012fd54 6255c234 001005f4 00000113 00000064 mfc90u!AfxWndProc+0x37
0012fd9c 76f7c4e7 001005f4 00000113 00000064 mfc90u!AfxWndProcBase+0x56
0012fdc8 76f7c5e7 6255c1de 001005f4 00000113 USER32!InternalCallWinProc+0x23
0012fe40 76f7cc19 001a910c 6255c1de 001005f4 USER32!UserCallWinProcCheckWow+0x14b
0012fea0 76f7cc70 6255c1de 00000000 0012fee0 USER32!DispatchMessageWorker+0x35e
0012feb0 6259e491 001a51c8 00000000 0041c6d0 USER32!DispatchMessageW+0xf
0012fec0 6259eb18 0041c6d0 0041c6d0 ffffffff mfc90u!AfxInternalPumpMessage+0x40
0012fee0 6256af81 0041c818 00000001 00000000 mfc90u!CWinThread::Run+0x5b
0012fef4 0040507f 00400000 00000000 00191e7e mfc90u!AfxWinMain+0x6a
0012ff88 757fee1c 7ffdd000 0012ffd4 770937eb Viewer+0x507f
0012ff94 770937eb 7ffdd000 78f1c642 00000000 kernel32!BaseThreadInitThunk+0xe
0012ffd4 770937be 004051ee 7ffdd000 00000000 ntdll!__RtlUserThreadStart+0x70
0012ffec 00000000 004051ee 7ffdd000 00000000 ntdll!_RtlUserThreadStart+0x1b


SYMBOL_STACK_INDEX:  0

SYMBOL_NAME:  msvcr90!memcpy+15c

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: MSVCR90

IMAGE_NAME:  MSVCR90.dll

DEBUG_FLR_IMAGE_TIMESTAMP:  4dace5b9

STACK_COMMAND:  ~0s ; kb

FAILURE_BUCKET_ID:  WRONG_SYMBOLS_c0000005_MSVCR90.dll!memcpy

BUCKET_ID:  APPLICATION_FAULT_WRONG_SYMBOLS_msvcr90!memcpy+15c

WATSON_STAGEONE_URL:  http://watson.microsoft.com/StageOne/Viewer_exe/1201_1404_202_0/533cc8c5/MSVCR90_dll/9_0_30729_6161/4dace5b9/c0000005/0003af7c.htm?Retriage=1

Followup: MachineOwner
---------

0:000> !load msec
0:000> !exploitable -v

!exploitable 1.6.0.0
HostMachine\HostUser
Executing Processor Architecture is x86
Debuggee is in User Mode
Debuggee is a live user mode debugging session on the local machine
Event Type: Exception
Exception Faulting Address: 0xa321000
First Chance Exception Type: STATUS_ACCESS_VIOLATION (0xC0000005)
Exception Sub-Type: Write Access Violation

Faulting Instruction:62eaaf7c mov dword ptr [edi+ecx*4-4],eax

Exception Hash (Major/Minor): 0x05af6d57.0x6cfc84d3

 Hash Usage : Stack Trace:
Major+Minor : MSVCR90!memcpy+0x15c
Major+Minor : MSVCR90!memcpy_s+0x4a
Major+Minor : mfc90u!ATL::Checked::memcpy_s+0x17
Major+Minor : mfc90u!CArchive::Read+0x49
Major+Minor : ISSymbol!DllUnregisterServer+0x1e8383
Minor       : ISSymbol!DllUnregisterServer+0x214a90
Minor       : ISSymbol!DllUnregisterServer+0x253c80
Minor       : ISSymbol!DllUnregisterServer+0x259f15
Minor       : ISSymbol!DllUnregisterServer+0x256f28
Minor       : ISSymbol!DllUnregisterServer+0x257e99
Minor       : ISSymbol!DllUnregisterServer+0x28029a
Minor       : ISSymbol!DllUnregisterServer+0x28110
Minor       : ISSymbol!DllUnregisterServer+0x1c17d
Minor       : ISSymbol!DllUnregisterServer+0x26108
Minor       : ISSymbol!DllUnregisterServer+0x182d6
Minor       : ISSymbol!DllUnregisterServer+0x12172
Minor       : ISSymbol!DllUnregisterServer+0x3582d
Minor       : mfc90u!_AfxDispatchCall+0x10
Minor       : mfc90u!COleDispatchImpl::Invoke+0x388
Minor       : mfc90u!COleDispatchDriver::InvokeHelperV+0x324
Minor       : mfc90u!COleControlSite::InvokeHelperV+0x57
Minor       : mfc90u!CWnd::InvokeHelper+0x27
Minor       : Viewer+0x21f1
Minor       : Viewer+0xd047
Minor       : Viewer+0xd0f4
Minor       : mfc90u!CWnd::OnWndMsg+0x407
Minor       : mfc90u!CWnd::WindowProc+0x24
Minor       : Viewer+0xa36c
Minor       : mfc90u!AfxCallWndProc+0xa3
Minor       : mfc90u!AfxWndProc+0x37
Minor       : mfc90u!AfxWndProcBase+0x56
Minor       : USER32!InternalCallWinProc+0x23
Minor       : USER32!UserCallWinProcCheckWow+0x14b
Minor       : USER32!DispatchMessageWorker+0x35e
Minor       : USER32!DispatchMessageW+0xf
Minor       : mfc90u!AfxInternalPumpMessage+0x40
Minor       : mfc90u!CWinThread::Run+0x5b
Minor       : mfc90u!AfxWinMain+0x6a
Minor       : Viewer+0x507f
Minor       : kernel32!BaseThreadInitThunk+0xe
Minor       : ntdll!__RtlUserThreadStart+0x70
Minor       : ntdll!_RtlUserThreadStart+0x1b
Instruction Address: 0x0000000062eaaf7c

Description: User Mode Write AV
Short Description: WriteAV
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at MSVCR90!memcpy+0x000000000000015c (Hash=0x05af6d57.0x6cfc84d3)

User mode write access violations that are not near NULL are exploitable.
0:000> .logclose
Closing open log file y:\crash2.log
